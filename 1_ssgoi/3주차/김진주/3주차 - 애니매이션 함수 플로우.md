# SSGOI 커스텀 애니메이션 함수 플로우
1. Transition 객체 구조
* Transition 타입은 in, out 두 가지 방향의 애니메이션을 정의합니다.
```
export type Transition<TContext = undefined, TAnimationValue = number> = {
    in?: GetTransitionConfig<TContext, TAnimationValue>;
    out?: GetTransitionConfig<TContext, TAnimationValue>;
    key?: TransitionKey;
};
```
* 각 방향은 GetTransitionConfig 타입의 함수로, HTMLElement(노드)와 필요시 context를 받아 TransitionConfig를 반환합니다.
```
export type GetTransitionConfig<TContext = undefined, TAnimationValue = number> = TContext extends undefined ? (node: HTMLElement) => TransitionConfig<TAnimationValue> | Promise<TransitionConfig<TAnimationValue>> : (node: HTMLElement, context: TContext) => TransitionConfig<TAnimationValue> | Promise<TransitionConfig<TAnimationValue>>;
```
---
2. TransitionConfig의 역할
* TransitionConfig는 실제 애니메이션의 옵션과 동작을 정의합니다.
```
export type TransitionConfig<TAnimationValue = number> = {
    spring?: SpringConfig;
    from?: TAnimationValue;
    to?: TAnimationValue;
    tick?: (progress: TAnimationValue) => void;
    prepare?: (element: HTMLElement) => void;
    wait?: () => Promise<void>;
    onStart?: () => void;
    onEnd?: () => void;
};
```
---
3. 실행 플로우
   1. 컴포넌트에서 Transition 객체를 전달
   2. 애니메이션 시작 시, in/out 함수가 호출됨
   3. prepare → wait → onStart 순서로 실행
   4. Animator가 spring 기반으로 progress 값을 계산
   5. progress가 변할 때마다 tick(progress) 호출
   6. 애니메이션 종료 시 onEnd 콜백 실행
```
const ssgoiConfig: SsgoiConfig = {
  transitions: [
    // Use hero transition between main and item detail pages
    {
      from: "/",
      to: "/item/*",
      transition: hero({ spring: { stiffness: 5, damping: 1 } }),
      symmetric: true,
    },
  ],
};

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    <html lang="en">
      <body>
        <Ssgoi config={ssgoiConfig}>
...
```
```
export type SggoiTransition = Transition<SggoiTransitionContext>;
export type SsgoiConfig = {
    transitions?: {
        from: string;
        to: string;
        transition: SggoiTransition;
        symmetric?: boolean;
    }[];
    defaultTransition?: SggoiTransition;
    middleware?: (from: string, to: string) => {
        from: string;
        to: string;
    };
};
```
4. 요약 플로우 다이어그램
  ``` 
  Transition.in/out(node) 
  
      ↓
  TransitionConfig 반환
  
      ↓
  prepare → wait → onStart
  
      ↓
  Animator가 progress 계산
  
      ↓
  tick(progress)로 스타일 변경
  
      ↓
    onEnd
```
